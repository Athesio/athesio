import React, { Component } from 'react';
import {SketchField, Tools} from 'react-sketch';




class WhiteBoard extends Component {
    constructor(props) {
      super(props);
      this.state = {
        sketch: "",
        tool: Tools.Pencil,
        lineColor: 'white',
        lineWidth: 5,
        defaultImage: ""
      }
      this.download = this.download.bind(this);
      this.eraser = this.eraser.bind(this);
      this.loadDefault = this.loadDefault.bind(this);

      //socket connections

      this.props.socket.on('updatedImage', (data)=>{
        console.log('new image from server', data);
        this.setState({defaultImage: data.image});
      })
    }

 


    download(){
        console.log('converting image', this.state.sketch.toDataURL());
    }

    eraser(){
        this.setState({lineColor:'black', lineWidth:50});
    }

    pen(){
        this.setState({lineColor:'white', lineWidth:5});
    }

    emit(){
        this.props.sendNewImage(this.state.sketch);
    }

    loadDefault(){
        this.setState({defaultImage: {"objects":[{"type":"path","originX":"left","originY":"top","left":6.5,"top":106.5,"width":154,"height":351,"fill":null,"stroke":"white","strokeWidth":5,"strokeDashArray":null,"strokeLineCap":"round","strokeLineJoin":"round","strokeMiterLimit":10,"scaleX":1,"scaleY":1,"angle":0,"flipX":false,"flipY":false,"opacity":1,"shadow":null,"visible":true,"clipTo":null,"backgroundColor":"","fillRule":"nonzero","globalCompositeOperation":"source-over","transformMatrix":null,"skewX":0,"skewY":0,"pathOffset":{"x":86,"y":284.5},"path":[["M",31.995,109],["Q",32,109,32.5,109],["Q",33,109,35,109],["Q",37,109,41.5,109],["Q",46,109,52,110],["Q",58,111,62,113.5],["Q",66,116,70.5,119],["Q",75,122,78.5,126],["Q",82,130,84.5,134],["Q",87,138,88,142.5],["Q",89,147,89,154],["Q",89,161,89,172.5],["Q",89,184,88.5,191.5],["Q",88,199,86,206.5],["Q",84,214,82.5,217.5],["Q",81,221,78.5,224.5],["Q",76,228,74.5,228.5],["Q",73,229,72,229],["Q",71,229,69.5,228.5],["Q",68,228,66.5,225],["Q",65,222,63,218],["Q",61,214,59.5,209.5],["Q",58,205,57.5,200.5],["Q",57,196,56.5,191],["Q",56,186,56,181],["Q",56,176,56.5,173.5],["Q",57,171,59,167],["Q",61,163,62.5,161],["Q",64,159,66.5,157],["Q",69,155,71.5,155],["Q",74,155,77.5,155],["Q",81,155,85,157],["Q",89,159,92.5,162.5],["Q",96,166,99,170.5],["Q",102,175,104.5,181.5],["Q",107,188,109,198.5],["Q",111,209,112,221.5],["Q",113,234,113,249],["Q",113,264,113,275.5],["Q",113,287,111.5,299],["Q",110,311,107,319.5],["Q",104,328,101,333],["Q",98,338,94.5,339.5],["Q",91,341,85,341.5],["Q",79,342,70.5,341],["Q",62,340,54.5,336.5],["Q",47,333,39.5,328],["Q",32,323,25.5,317],["Q",19,311,15.5,305.5],["Q",12,300,10.5,294],["Q",9,288,9,279.5],["Q",9,271,10,263],["Q",11,255,17.5,246.5],["Q",24,238,34.5,228.5],["Q",45,219,54,214],["Q",63,209,72,206.5],["Q",81,204,94,203.5],["Q",107,203,117,205.5],["Q",127,208,135.5,215.5],["Q",144,223,149,231.5],["Q",154,240,158,251],["Q",162,262,162.5,271.5],["Q",163,281,163,289.5],["Q",163,298,161.5,304],["Q",160,310,158,315.5],["Q",156,321,151.5,327.5],["Q",147,334,144,338],["Q",141,342,138.5,344],["Q",136,346,134,347.5],["Q",132,349,129.5,350],["Q",127,351,125,351],["Q",123,351,121,351],["Q",119,351,116.5,349.5],["Q",114,348,112,345],["Q",110,342,107.5,337.5],["Q",105,333,103,328.5],["Q",101,324,100,320.5],["Q",99,317,98,313],["Q",97,309,96.5,304.5],["Q",96,300,96,297],["Q",96,294,96,291],["Q",96,288,96,283.5],["Q",96,279,96,275],["Q",96,271,96.5,267],["Q",97,263,98,260],["Q",99,257,99.5,255.5],["Q",100,254,101,252.5],["Q",102,251,102.5,250.5],["Q",103,250,103.5,250],["Q",104,250,105,250],["Q",106,250,107,252],["Q",108,254,109.5,258.5],["Q",111,263,112,269],["Q",113,275,114,282],["Q",115,289,116,295],["Q",117,301,117.5,308],["Q",118,315,118.5,321.5],["Q",119,328,120,332],["Q",121,336,121.5,339.5],["Q",122,343,122,344],["Q",122,345,122,346],["Q",122,347,122,349.5],["Q",122,352,123,359],["Q",124,366,125.5,373.5],["Q",127,381,128.5,393.5],["Q",130,406,131.5,417],["Q",133,428,133.5,435.5],["Q",134,443,134,446.5],["Q",134,450,134,452],["Q",134,454,134,455],["Q",134,456,134,457],["Q",134,458,133.5,458.5],["Q",133,459,132,459.5],["Q",131,460,129,460],["Q",127,460,124,460],["Q",121,460,118,458],["Q",115,456,111,453],["Q",107,450,100.5,443],["Q",94,436,90,431],["Q",86,426,84,422],["Q",82,418,79.5,412.5],["Q",77,407,77,403],["Q",77,399,77,394],["Q",77,389,77,384],["Q",77,379,78.5,374],["Q",80,369,81,366],["Q",82,363,83.5,360.5],["Q",85,358,85.5,357],["Q",86,356,86.5,356],["Q",87,356,87.5,358],["Q",88,360,89.5,368],["Q",91,376,92,382],["Q",93,388,93,391],["Q",93,394,93,397],["Q",93,400,92.5,402],["Q",92,404,90.5,404.5],["Q",89,405,87.5,406],["Q",86,407,84.5,407.5],["Q",83,408,81,408],["Q",79,408,77.5,408],["Q",76,408,74,408],["Q",72,408,71,406],["Q",70,404,69,401],["Q",68,398,67.5,393.5],["Q",67,389,67,386.5],["Q",67,384,67,378],["L",67,371.995]]},{"type":"path","originX":"left","originY":"top","left":-22,"top":-84,"width":183,"height":606.88,"fill":null,"stroke":"black","strokeWidth":50,"strokeDashArray":null,"strokeLineCap":"round","strokeLineJoin":"round","strokeMiterLimit":10,"scaleX":1,"scaleY":1,"angle":0,"flipX":false,"flipY":false,"opacity":1,"shadow":null,"visible":true,"clipTo":null,"backgroundColor":"","fillRule":"nonzero","globalCompositeOperation":"source-over","transformMatrix":null,"skewX":0,"skewY":0,"pathOffset":{"x":94.5,"y":244.4375},"path":[["M",52,194.95],["Q",52,195,52,201],["Q",52,207,52,216.5],["Q",52,226,52,250],["Q",52,274,52,318.5],["Q",52,363,53.5,404.5],["Q",55,446,56,462],["Q",57,478,57.5,491],["Q",58,504,58.5,512],["Q",59,520,59,522],["Q",59,524,58.5,515],["Q",58,506,47.5,444.5],["Q",37,383,28,313],["Q",19,243,14,177.5],["Q",9,112,6.5,67],["Q",4,22,3.5,9.5],["Q",3,-3,3,-21],["Q",3,-39,3,-46.5],["Q",3,-54,3,-55],["Q",3,-56,3,-56.5],["Q",3,-57,3.5,-57.5],["Q",4,-58,5,-58.5],["Q",6,-59,8.5,-59],["Q",11,-59,21.5,-54],["Q",32,-49,52.5,-23.5],["Q",73,2,89,28.5],["Q",105,55,114.5,77],["Q",124,99,129,113],["Q",134,127,137.5,140.5],["Q",141,154,142,161],["Q",143,168,143,179.5],["Q",143,191,141,197],["Q",139,203,137.5,210.5],["Q",136,218,134.5,226],["Q",133,234,132,238.5],["Q",131,243,130,246.5],["Q",129,250,128,251],["Q",127,252,124,252.5],["Q",121,253,99,219.5],["Q",77,186,61,149],["Q",45,112,45,115],["Q",45,118,45,130.5],["Q",45,143,45,162],["Q",45,181,45,241],["Q",45,301,49,341.5],["Q",53,382,57.5,417],["Q",62,452,66,475.5],["Q",70,499,72.5,513],["Q",75,527,77,537],["Q",79,547,79.5,547.5],["Q",80,548,80,547.5],["Q",80,547,78.5,531],["Q",77,515,70.5,471.5],["Q",64,428,58.5,377],["Q",53,326,51.5,303],["Q",50,280,48.5,260.5],["Q",47,241,46,224.5],["Q",45,208,45,202.5],["Q",45,197,45,195],["Q",45,193,45,191.5],["Q",45,190,45,189.5],["Q",45,189,46,188.5],["Q",47,188,50,187.5],["Q",53,187,61.5,187.5],["Q",70,188,92.5,208.5],["Q",115,229,123,242.5],["Q",131,256,138.5,274],["Q",146,292,148.5,303],["Q",151,314,153.5,327],["Q",156,340,157,351.5],["Q",158,363,158.5,370.5],["Q",159,378,159.5,383.5],["Q",160,389,160.5,391.5],["Q",161,394,161,395],["Q",161,396,161,396.5],["Q",161,397,160.5,397],["Q",160,397,155.5,389.5],["Q",151,382,148,377.5],["Q",145,373,143,370.5],["Q",141,368,139.5,366],["Q",138,364,137,363.5],["Q",136,363,135.5,364],["Q",135,365,133.5,371],["Q",132,377,130.5,382.5],["Q",129,388,127,396],["Q",125,404,123.5,408.5],["Q",122,413,120,417.5],["Q",118,422,117.5,424],["Q",117,426,116,426.5],["Q",115,427,114.5,427.5],["Q",114,428,113.5,426.5],["Q",113,425,110.5,416],["Q",108,407,101.5,385.5],["Q",95,364,89.5,342.5],["Q",84,321,82,311],["Q",80,301,77.5,290],["Q",75,279,74,275],["Q",73,271,73,270],["Q",73,269,73,269.5],["Q",73,270,73,274],["Q",73,278,73,287],["Q",73,296,73.5,309.5],["Q",74,323,75.5,335],["Q",77,347,78.5,354],["Q",80,361,80.5,364],["Q",81,367,81,367.5],["Q",81,368,81.5,368],["Q",82,368,82,366.5],["Q",82,365,82,360],["Q",82,355,83,346.5],["Q",84,338,85.5,329.5],["Q",87,321,88.5,312.5],["Q",90,304,92,299.5],["Q",94,295,96.5,291],["Q",99,287,100,286.5],["Q",101,286,102,286],["Q",103,286,105.5,290.5],["Q",108,295,111,305],["Q",114,315,118,328.5],["Q",122,342,123.5,348],["Q",125,354,127,360.5],["Q",129,367,129.5,370.5],["Q",130,374,130.5,375.5],["Q",131,377,131,374],["Q",131,371,128,358],["Q",125,345,123,335.5],["Q",121,326,119,311.5],["Q",117,297,115.5,286],["Q",114,275,113.5,269],["Q",113,263,113,260],["Q",113,257,113,256],["Q",113,255,113,255.5],["Q",113,256,116,267.5],["Q",119,279,124,299.5],["Q",129,320,133,339],["Q",137,358,139.5,374.5],["Q",142,391,144,408.5],["Q",146,426,147.5,439],["Q",149,452,149.5,456.5],["Q",150,461,150,463.5],["Q",150,466,150,466.5],["Q",150,467,150,466.5],["Q",150,466,150,465.5],["Q",150,465,149,463],["Q",148,461,145.5,456],["Q",143,451,141.5,448.5],["Q",140,446,137,443],["Q",134,440,132.5,439],["Q",131,438,129.5,438],["Q",128,438,126.5,438],["Q",125,438,123.5,438.5],["Q",122,439,119.5,439],["Q",117,439,114.5,439],["Q",112,439,109.5,436],["Q",107,433,103,425.5],["Q",99,418,96.5,405],["Q",94,392,93,364],["Q",92,336,92,325],["Q",92,314,92,304.5],["Q",92,295,94.5,287],["Q",97,279,98,278.5],["Q",99,278,99.5,278],["Q",100,278,101,278.5],["Q",102,279,102.5,280],["Q",103,281,103.5,281.5],["Q",104,282,104,281.5],["Q",104,281,104,278.5],["Q",104,276,102.5,259.5],["Q",101,243,98.5,210.5],["Q",96,178,94.5,147.5],["Q",93,117,92.5,81.5],["Q",92,46,92,37.5],["Q",92,29,92,16],["Q",92,3,91.5,1.5],["Q",91,0,90.5,2],["Q",90,4,89.5,10],["Q",89,16,88.5,29],["Q",88,42,88,52.5],["Q",88,63,88,79],["Q",88,95,88,109.5],["Q",88,124,90.5,141],["Q",93,158,96.5,176.5],["Q",100,195,101.5,205.5],["Q",103,216,104.5,224.5],["Q",106,233,106.5,235.5],["Q",107,238,107,238.5],["Q",107,239,107,237],["Q",107,235,106,231],["Q",105,227,103,220],["Q",101,213,97.5,195.5],["Q",94,178,92.5,151],["Q",91,124,91,100.5],["Q",91,77,91,61.5],["Q",91,46,92.5,38.5],["Q",94,31,97.5,23],["Q",101,15,105.5,15],["Q",110,15,119.5,25],["Q",129,35,140.5,56.5],["Q",152,78,161.5,105.5],["Q",171,133,175,153.5],["Q",179,174,182,201],["Q",185,228,185.5,252],["Q",186,276,186,287],["Q",186,298,186,304.5],["Q",186,311,185,316.5],["Q",184,322,183,324],["Q",182,326,181,326.5],["Q",180,327,178,327.5],["Q",176,328,175.5,327.5],["Q",175,327,174.5,326],["Q",174,325,173.5,323.5],["Q",173,322,171.5,318],["Q",170,314,169,306.5],["Q",168,299,165.5,285],["Q",163,271,161.5,261],["Q",160,251,159.5,244],["Q",159,237,158.5,229],["Q",158,221,158,220],["Q",158,219,158,217.5],["Q",158,216,158,215],["Q",158,214,158,213.5],["Q",158,213,158.5,213],["Q",159,213,159.5,213],["Q",160,213,160.5,213],["Q",161,213,161.5,213],["Q",162,213,162.5,213],["Q",163,213,163,213.5],["Q",163,214,163.5,217.5],["Q",164,221,165,235.5],["Q",166,250,166,271.5],["Q",166,293,166,309.5],["Q",166,326,166,337],["Q",166,348,165.5,357.5],["Q",165,367,164,370.5],["Q",163,374,162,374],["Q",161,374,160.5,373.5],["Q",160,373,158,368],["Q",156,363,148.5,338.5],["Q",141,314,131.5,265.5],["Q",122,217,118,173.5],["Q",114,130,112.5,93.5],["Q",111,57,111,45],["Q",111,33,111,17],["Q",111,1,111,-5],["Q",111,-11,111,-12],["Q",111,-13,111,-13.5],["Q",111,-14,111.5,-8],["Q",112,-2,114,14.5],["Q",116,31,119,60],["Q",122,89,123.5,111.5],["Q",125,134,126,151.5],["Q",127,169,127.5,178],["Q",128,187,128,194],["Q",128,201,128,204],["Q",128,207,128,207.5],["Q",128,208,128,207.5],["Q",128,207,128,206.5],["L",128,205.95]]},{"type":"path","originX":"left","originY":"top","left":28.5,"top":83.5,"width":76.88,"height":61,"fill":null,"stroke":"white","strokeWidth":5,"strokeDashArray":null,"strokeLineCap":"round","strokeLineJoin":"round","strokeMiterLimit":10,"scaleX":1,"scaleY":1,"angle":0,"flipX":false,"flipY":false,"opacity":1,"shadow":null,"visible":true,"clipTo":null,"backgroundColor":"","fillRule":"nonzero","globalCompositeOperation":"source-over","transformMatrix":null,"skewX":0,"skewY":0,"pathOffset":{"x":69.4375,"y":116.5},"path":[["M",61.005,102],["Q",61,102,60.5,102],["Q",60,102,59,102],["Q",58,102,56.5,102],["Q",55,102,52.5,102],["Q",50,102,47,102],["Q",44,102,41.5,102],["Q",39,102,37,102],["Q",35,102,33.5,102],["Q",32,102,31.5,102.5],["Q",31,103,31,104],["Q",31,105,31,106],["Q",31,107,31,108],["Q",31,109,31,110.5],["Q",31,112,31,113],["Q",31,114,31,115],["Q",31,116,31,117],["Q",31,118,31,118.5],["Q",31,119,32,120],["Q",33,121,33.5,122],["Q",34,123,34.5,124.5],["Q",35,126,36,127],["Q",37,128,38,129.5],["Q",39,131,40.5,133],["Q",42,135,43.5,136.5],["Q",45,138,45.5,138.5],["Q",46,139,47.5,140],["Q",49,141,49,141.5],["Q",49,142,50,142],["Q",51,142,52,142],["Q",53,142,53.5,142],["Q",54,142,55,142],["Q",56,142,56.5,142],["Q",57,142,57.5,142],["Q",58,142,58,141.5],["Q",58,141,58,140.5],["Q",58,140,58,139.5],["Q",58,139,58,138.5],["Q",58,138,58,137.5],["Q",58,137,58,136.5],["Q",58,136,58.5,135.5],["Q",59,135,59.5,134.5],["Q",60,134,60.5,133.5],["Q",61,133,61.5,133],["Q",62,133,62.5,132.5],["Q",63,132,63.5,132],["Q",64,132,64,132.5],["Q",64,133,64,133.5],["Q",64,134,64,134.5],["Q",64,135,64,135.5],["Q",64,136,64.5,136.5],["Q",65,137,65.5,137.5],["Q",66,138,67,138.5],["Q",68,139,70,140],["Q",72,141,73.5,142],["Q",75,143,77.5,143.5],["Q",80,144,81.5,144.5],["Q",83,145,84.5,145.5],["Q",86,146,87,146.5],["Q",88,147,88.5,147],["Q",89,147,89.5,147],["Q",90,147,90.5,147],["Q",91,147,91,146.5],["Q",91,146,91.5,146],["Q",92,146,92,145.5],["Q",92,145,92,144.5],["Q",92,144,92.5,143.5],["Q",93,143,93,142.5],["Q",93,142,93,141],["Q",93,140,93,139.5],["Q",93,139,93,138],["Q",93,137,93,136.5],["Q",93,136,92.5,135],["Q",92,134,91.5,132.5],["Q",91,131,91,130],["Q",91,129,90.5,127.5],["Q",90,126,89.5,124.5],["Q",89,123,89,121.5],["Q",89,120,88.5,118.5],["Q",88,117,88,115.5],["Q",88,114,88,113],["Q",88,112,87.5,111],["Q",87,110,87,109],["Q",87,108,86.5,108],["Q",86,108,86,107.5],["Q",86,107,85.5,107],["Q",85,107,84.5,106.5],["Q",84,106,84,105.5],["Q",84,105,84,104.5],["Q",84,104,84,103.5],["Q",84,103,84,102.5],["Q",84,102,84,101],["Q",84,100,84.5,98.5],["Q",85,97,85.5,96],["Q",86,95,86.5,94],["Q",87,93,87.5,92],["Q",88,91,89,90.5],["Q",90,90,90.5,89.5],["Q",91,89,91.5,89],["Q",92,89,92.5,89],["Q",93,89,94,89],["Q",95,89,95.5,89],["Q",96,89,97,89],["Q",98,89,98.5,89],["Q",99,89,101,89],["Q",103,89,104,89.5],["Q",105,90,105.5,90],["Q",106,90,106.5,90.5],["Q",107,91,107.5,91.5],["Q",108,92,107.5,92],["Q",107,92,106.5,91.5],["Q",106,91,105.5,90.5],["Q",105,90,104,90],["Q",103,90,102.5,90],["Q",102,90,101.5,89.5],["Q",101,89,100,89],["Q",99,89,98.5,89],["Q",98,89,97,88.5],["Q",96,88,95,88],["Q",94,88,93.5,87.5],["Q",93,87,92.5,87],["Q",92,87,91.5,86.5],["Q",91,86,90.5,86],["Q",90,86,89.5,86],["Q",89,86,88.5,86],["Q",88,86,87.5,86],["Q",87,86,86.5,86.5],["Q",86,87,85,87],["Q",84,87,83.5,87.5],["Q",83,88,82.5,88.5],["Q",82,89,81.5,89],["Q",81,89,80.5,89.5],["Q",80,90,79.5,90],["Q",79,90,79,90.5],["Q",79,91,78.5,91],["Q",78,91,77.5,91.5],["Q",77,92,76.5,92.5],["Q",76,93,75.5,93],["Q",75,93,74.5,93.5],["Q",74,94,73.5,94],["Q",73,94,72.5,94.5],["Q",72,95,71.5,95],["Q",71,95,70,95.5],["Q",69,96,68.5,96],["Q",68,96,67.5,96.5],["Q",67,97,66.5,97],["Q",66,97,65.5,97.5],["Q",65,98,64,98.5],["Q",63,99,61.5,99.5],["Q",60,100,59.5,100],["Q",59,100,58.5,100],["Q",58,100,57,100.5],["Q",56,101,55.5,101],["Q",55,101,54.5,101],["Q",54,101,53,101],["Q",52,101,51.5,101],["Q",51,101,50.5,101],["L",49.995,101]]}]}})
        console.log('loading image');   
    }


    render(){
        return(
    

            <div style={{ backgroundColor: 'black'}}>
            <button onClick ={()=>{this.eraser();  console.log('clicked')}}>Eraser</button>
            <button onClick ={()=>{this.pen(); console.log('clicked')}}>Pen</button>
            <button onClick ={()=>{this.download(); console.log('clicked')}}>Save</button>
            <button onClick ={()=>{this.emit(); console.log('clicked')}}>Emit</button>
            <button onClick ={()=>{this.loadDefault()}}>Load</button>
            <SketchField
                    ref={(c) => {
                     return this.state.sketch = c  
                  }}
                   defaultValue={this.state.defaultImage}
                   value={this.state.defaultImage}
                   tool={this.state.tool} 
                   lineColor={this.state.lineColor}
                   lineWidth={this.state.lineWidth}/>
            </div>
        )
    }
}

export default WhiteBoard